<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>API · AbnormalReturns.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">AbnormalReturns.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Introduction</a></li><li><a class="tocitem" href="../example/">Example</a></li><li class="is-active"><a class="tocitem" href>API</a><ul class="internal"><li><a class="tocitem" href="#Setting-Up-Data"><span>Setting Up Data</span></a></li><li><a class="tocitem" href="#Regression-Related-Methods"><span>Regression Related Methods</span></a></li><li><a class="tocitem" href="#Calculation-Functions"><span>Calculation Functions</span></a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>API</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>API</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/junder873/AbnormalReturns.jl/blob/main/docs/src/api.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="AbnormalReturns-API"><a class="docs-heading-anchor" href="#AbnormalReturns-API">AbnormalReturns API</a><a id="AbnormalReturns-API-1"></a><a class="docs-heading-anchor-permalink" href="#AbnormalReturns-API" title="Permalink"></a></h1><p>This package reexports <a href="https://raw.githubusercontent.com/JuliaStats/StatsModels.jl">StatsModels.jl</a> and <a href="https://github.com/JuliaFinance/BusinessDays.jl">BusinessDays.jl</a>. See those packages and their respective documentation for methods that they export.</p><p>Notable methods from <a href="https://raw.githubusercontent.com/JuliaStats/StatsModels.jl">StatsModels.jl</a>:</p><ul><li><code>@formula</code></li></ul><p>Notable methods from <a href="https://github.com/JuliaFinance/BusinessDays.jl">BusinessDays.jl</a>:</p><ul><li><code>advancebdays</code></li><li><code>bdayscount</code></li><li><code>tobday</code></li></ul><h2 id="Setting-Up-Data"><a class="docs-heading-anchor" href="#Setting-Up-Data">Setting Up Data</a><a id="Setting-Up-Data-1"></a><a class="docs-heading-anchor-permalink" href="#Setting-Up-Data" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="AbnormalReturns.MarketData" href="#AbnormalReturns.MarketData"><code>AbnormalReturns.MarketData</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">function MarketData(
    df_market,
    df_firms;
    date_col_market=:date,
    date_col_firms=:date,
    id_col=:permno,
    add_intercept_col=true,
    valuecols_market=nothing,
    valuecols_firms=nothing
)</code></pre><p><strong>Arguments</strong></p><ul><li><code>df_market</code>: A Tables.jl compatible source that stores market data, indexed by date.   The dates must be a unique set. The column name for the date column is specified   by the keyword argument &quot;date<em>col</em>market&quot;</li><li><code>df_firms</code>: A Tables.jl compatible source that stores firm data. Each firm must have a   unique set of dates. The column name for the date column is specified   by the keyword argument &quot;date<em>col</em>firms&quot; and the firm ID column is specified   by the keyword argument &quot;id_col&quot;</li><li><code>valuecols_market=nothing</code>: If left as nothing, all other columns in <code>df_market</code> are   used as the value columns. These are the columns that are stored in the resulting   dataset. Otherwise a vector of Symbol or String specifying column names.</li><li><code>valuecols_firms=nothing</code>: Same as above</li><li><code>id_col=:permno</code>: The column corresponding to the set of firm IDs in <code>df_firms</code></li><li><code>add_intercept_col=true</code>: Whether to add a column to the data for an intercept (which is   always equal to 1)</li></ul><p>MarketData is the main data storage structure. Data is stored for each firm in a Dict, where the data itself is a NamedTuple (names corresponding to column names, such as &quot;ret&quot;), and the keys for the Dict corresponding to firm IDs. The MarketData struct also stores overall market data and a calendar of dates.</p><p>Any firm data must have a corresponding market data date, so there cannot be a firm return if there is not a market return on that date.</p><p><strong>Example</strong></p><pre><code class="language- hljs">df_firm = CSV.File(joinpath(data_dir, &quot;daily_ret.csv&quot;))
df_mkt = CSV.File(joinpath(data_dir, &quot;mkt_ret.csv&quot;))
df_mkt[!, :mkt] = df_mkt.mktrf .+ df_mkt.rf
mkt_data = MarketData(
    df_mkt,
    df_firm
)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/junder873/AbnormalReturns.jl/blob/9475943662fd9581986a8b5b3429254c105839a6/src/timelineData.jl#L115-L162">source</a></section></article><h2 id="Regression-Related-Methods"><a class="docs-heading-anchor" href="#Regression-Related-Methods">Regression Related Methods</a><a id="Regression-Related-Methods-1"></a><a class="docs-heading-anchor-permalink" href="#Regression-Related-Methods" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="AbnormalReturns.quick_reg" href="#AbnormalReturns.quick_reg"><code>AbnormalReturns.quick_reg</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">quick_reg(
    data::FixedTable,
    f::FormulaTerm;
    minobs::Real=0.8,
    save_residuals::Bool=false
)

quick_reg(
    data::IterateFixedTable,
    f::FormulaTerm;
    minobs::Real=0.8,
    save_residuals::Bool=false
)</code></pre><p>Calculates a linear regression for the supplied data based on the formula (formula from StatsModels.jl). Unless the formula explicitly excludes the intercept (i.e., <code>@formula(y ~ 0 + x)</code>), an intercept is added.</p><p>If <code>data</code> is of the type <code>IterateFixedTable</code>, then the function uses the maximum number of threads on each <code>FixedTable</code> in an optimized way and returns a <code>Vector{BasicReg}</code>.</p><p><strong>Arguments</strong></p><ul><li><code>minobs::Real</code>: The minimum number of observations to return a completed regression. If less than 1,   the value is used as a percentage relative to the total number of business days in the time period.   Therefore, the default of 0.8 corresponds to at least 80% of the business days over the time period have values.</li><li><code>save_residuals::Bool=false</code>: Whether to save the residuals into <code>BasicReg</code>, This can have significant performance implications.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/junder873/AbnormalReturns.jl/blob/9475943662fd9581986a8b5b3429254c105839a6/src/fastRegression.jl#L96-L124">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="AbnormalReturns.BasicReg" href="#AbnormalReturns.BasicReg"><code>AbnormalReturns.BasicReg</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">function BasicReg(
    resp::AbstractVector,
    pred::AbstractMatrix,
    yname::String,
    xnames::SVector{N, String},
    f::FormulaTerm{L,R};
    save_residuals::Bool=false,
    minobs=1
)::BasicReg{L,R} where {L,R}</code></pre><p><strong>Arguments</strong></p><ul><li>resp::AbstractVector{Float64}: The &quot;Y&quot; or response in a linear regression</li><li>pred::AbstractMatrix{Float64}: The &quot;X&quot; matrix in a linear regression</li><li>yname::String: The name of the response variable</li><li>xnames::SVector{N, String}: The names of the prediction variables</li><li>f::FormulaTerm{L,R}: A StatsModels.jl formula, saved in the resulting struct</li><li>save_residuals::Bool=false: Whether or not to save the vector of residuals from   the regression. Note for large numbers of regressions this can significantly slow   down the speed</li><li>minobs::Int=1: The minimum length of the response vector for the regression to   run. The regression will also not run if the length of the response vector is   less than or equal to the number of columns in the prediction matrix.</li></ul><p>BasicReg is an intentionally simplistic linear regression. It also attempts to produce a minimum number of allocations if views of vectors are passed.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/junder873/AbnormalReturns.jl/blob/9475943662fd9581986a8b5b3429254c105839a6/src/fastRegression.jl#L22-L48">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="AbnormalReturns.alpha" href="#AbnormalReturns.alpha"><code>AbnormalReturns.alpha</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">alpha(rr::RegressionModel, coefname::String...=&quot;intercept&quot;)</code></pre><p>&quot;alpha&quot; in respect to the the CAPM model, i.e., the intercept in the model. This is the alpha from the estimation period.</p><p>This function finds the position of the coefficient name provided, defaults to &quot;intercept&quot;. If the coefname is not in the regression, then this function returns an error.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/junder873/AbnormalReturns.jl/blob/9475943662fd9581986a8b5b3429254c105839a6/src/calcFunctions.jl#L301-L309">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="AbnormalReturns.beta" href="#AbnormalReturns.beta"><code>AbnormalReturns.beta</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">beta(rr::RegressionModel, coefname::String...=[&quot;mkt&quot;, &quot;mktrf&quot;, &quot;vwretd&quot;, &quot;ewretd&quot;])</code></pre><p>&quot;beta&quot; in respect to the CAPM model, i.e., the coefficient on the market return minus the risk free rate. This is the beta from the estimation period.</p><p>This function finds the position of the coefficient name provided, defaults to several common market returns. If the coefname is not in the regression, then this function returns an error.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/junder873/AbnormalReturns.jl/blob/9475943662fd9581986a8b5b3429254c105839a6/src/calcFunctions.jl#L314-L322">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Statistics.var" href="#Statistics.var"><code>Statistics.var</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">var[std](rr::Union{AbstractVector{&lt;:RegressionModel}, RegressionModel})
var[std](data::Union{IterateFixedTable, FixedTable}; minobs=0.8)</code></pre><p>If a regression model is passed, then this calculates the variance (standard deviation) based on the residual sum of squares divided by the degrees of freedom. A vector of RegressionModel will return the same length of vector results.</p><p>If a FixedTable is passed (or an IterateFixedTable), and that contains only one column, then the variance (standard deviation) is calculated for that column. If it has two columns, then the calculation is based on the difference between the columns.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/junder873/AbnormalReturns.jl/blob/9475943662fd9581986a8b5b3429254c105839a6/src/calcFunctions.jl#L241-L252">source</a></section></article><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>std</code>. Check Documenter&#39;s build log for details.</p></div></div><h2 id="Calculation-Functions"><a class="docs-heading-anchor" href="#Calculation-Functions">Calculation Functions</a><a id="Calculation-Functions-1"></a><a class="docs-heading-anchor-permalink" href="#Calculation-Functions" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="AbnormalReturns.bhar" href="#AbnormalReturns.bhar"><code>AbnormalReturns.bhar</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">bhar(
    data::FixedTable{T, 2};
    minobs=0.8
) where {T}

bhar(
    data::FixedTable,
    rr::RegressionModel;
    minobs=0.8
)

bhar(
    data::IterateFixedTable{T, 2};
    minobs=0.8
) where {T, MNames, FNames}

bhar(
    data::IterateFixedTable,
    rrs::AbstractVector{&lt;:BasicReg};
    minobs=0.8
)</code></pre><p>Calculates the difference between buy and hold returns (also referred to as geometric returns) for a firm and a benchmark. If a regression is passed, then the benchmark is based on the coefficients from that regression and the performance of the benchmarks in the regression. These are sometimes called Fama-French abnormal returns. If no regression is passed, abnormal returns are calculated as the difference between the first and second columns in the FixedTable (second column is typically the benchmark such as the S&amp;P 500 or a value weighted return of all firms).</p><p>Similar to constructing the regression, passing an <code>IterateFixedTable</code> will return a Vector and uses a more optimized method.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/junder873/AbnormalReturns.jl/blob/9475943662fd9581986a8b5b3429254c105839a6/src/calcFunctions.jl#L172-L202">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="AbnormalReturns.car" href="#AbnormalReturns.car"><code>AbnormalReturns.car</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">car(
    data::FixedTable{T, 2};
    minobs=0.8
) where {T}

car(
    data::FixedTable,
    rr::RegressionModel;
    minobs=0.8
)

car(
    data::IterateFixedTable{T, 2};
    minobs=0.8
) where {T, MNames, FNames}

car(
    data::IterateFixedTable,
    rrs::AbstractVector{&lt;:BasicReg};
    minobs=0.8
)</code></pre><p>Calculates the cumulative returns of a firm over a benchmark (through addition of each return). If a regression is passed, then the benchmark is based on the coefficients from that regression and the performance of the benchmarks in the regression. These are sometimes called Fama-French abnormal returns. If no regression is passed, abnormal returns are calculated as the difference between the first and second columns in the FixedTable (second column is typically the benchmark such as the S&amp;P 500 or a value weighted return of all firms).</p><p>Similar to constructing the regression, passing an <code>IterateFixedTable</code> will return a Vector and uses a more optimized method.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/junder873/AbnormalReturns.jl/blob/9475943662fd9581986a8b5b3429254c105839a6/src/calcFunctions.jl#L206-L236">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="AbnormalReturns.bh_return" href="#AbnormalReturns.bh_return"><code>AbnormalReturns.bh_return</code></a> — <span class="docstring-category">Function</span></header><section><div><p>Calculates the buy and hold returns (also called geometric return).</p><p>These functions treat missing returns in the period implicitly as a zero return.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/junder873/AbnormalReturns.jl/blob/9475943662fd9581986a8b5b3429254c105839a6/src/calcFunctions.jl#L51-L56">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../example/">« Example</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.25 on <span class="colophon-date" title="Friday 25 August 2023 18:41">Friday 25 August 2023</span>. Using Julia version 1.9.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
